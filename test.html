<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <title>Document</title>
    <script>
        // Post 저장 test
        function savePost() {
            $.ajax({
                type: 'POST',
                url: '/api/posts',
                data: {
                    user_name : "test010",
                    title : "test010",
                    content : "test010",
                    createdAt : "test010"
                        },
                success: function (response) {   
                    alert('저장완료')
                    location.href = '/' 
                    console.log(response)
                }
            })
        }
        
        // Post 수정 test
        function modifyPost(){
            var post_id = 8
            $.ajax({
                type: 'POST',
                url: `/api/modify/${post_id}`,
                data: {
                    post_id : post_id,
                    title : "modify teest008",
                    user_name : "modify teest008",
                    content : "modify teest008",
                    createdAt : "modify teest008"
                    },
                success: function (response) {
                    alert('수정완료')
                    console.log(response)  
                    location.href = '/'   
                }
            })
        }

        // Post 삭제 test
        function deletePost(){
            var post_id = 6
            $.ajax({
                type: 'delete',
                url: `/api/delete/${post_id}`,
                data: {
                    post_id : post_id,                    
                    },
                success: function (response) {
                    alert('삭제완료')
                    console.log(response)
                    location.href = '/'     
                }
            })
        }

        // Main Page -> Post List test
        $(document).ready(function () {
            postlist();
        });
        function postlist() { 
            $.ajax({
                type: 'GET',
                url: '/api/main',
                dataType:'json',
                data: {},
                success: function (response) {
                    var postList = response.result;
                    console.log('postList-->',postList);
                    var str = "";
                    for(var i=0;i<postList.length;i++){
                        str+='<div>{';
                        str+='<div>post_id : '+postList[i].post_id+'</div>';
                        str+='<div>user_name : '+postList[i].user_name+'</div>';
                        str+='<div>title : '+postList[i].title+'</div>';
                        str+='<div>content : '+postList[i].content+'</div>';
                        str+='<div>createdAt : '+postList[i].createdAt+'</div>';
                        str+='</div>}';
                    }
                    $('#post_List').append(str);
                }
            })
        }

        // image file upload
        // function imageSave(){
        //     // var post_id = 10;
        //     const imageInput = $('#imageInput')[0]; // upload file 선택
        //     // console.log('file-->',imageInput.files);
        //     const formData = new FormData();
        //     // 0번째 파일을 FormData 객체 안에 append
        //     formData.append("image", imageInput.files[0]);
        //     for (var key of formData.keys()) {
        //         console.log('key-->',key);
        //     }
        //     for (var value of formData.values()) {
        //         console.log('value-->',value);
        //     }

        //     $.ajax({
        //         type: 'post',
        //         url: '/api/imageUrl',
        //         //contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송
        //         contentType : false,
        //         //processData : false로 선언 시 formData를 string으로 변환하지 않음
        //         processData : false,
        //         data: formData,
        //         success: function (response) {
        //         }
        //     })
        // }

    </script>
</head>
<body>
    <!-- <button id="savePost" onclick="savePost()">savePost</button>
    <button id="modifyPost" onclick="modifyPost()">modifyPost</button>
    <button id="deletePost" onclick="deletePost()">deletePost</button>

    <-- file upload -->
    <!-- <form id="fileUploadForm" enctype="multipart/form-data">
        <input type="file" id="imageInput" accept="image/*" name="uploadFile"/>
        <input type="button" onclick="imageSave()" value="파일업로드">
        <div>이미지 미리보기</div>
        <div id="imagePreview">
            <img id="img">
        </div>
    </form>

    <div id="post_List">POST LIST</div> -->

    
    
    
</body>
</html>